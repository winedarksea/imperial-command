#R Code for Linear Regression of combined Cancer and Census Data from DataWorld

require(readxl)
values <- read_excel("FastFood.xlsx")
attach(values)

#Plotting quadratic equations
Qlm <-lm(Revenue~Income + IncomeSqd)
XvaluesQ <- seq(15,35)
YvaluesQ <- Qlm$coefficients[3]* XvaluesQ^2 + Qlm$coefficients[2]*XvaluesQ + Qlm$coefficients[1]
plot(Income, Revenue)
lines(XvaluesQ, YvaluesQ, col = 'darkseagreen')
summary(Qlm)

#attach/detach causes troubles
#For first-order equation
polishing <-  read_excel("Polishing.xlsx")
polishing$type <- factor(polishing$type)
polishing$type <- relevel(polishing$type, ref = 5)
polishing <-  within(polishing, polishing$type)
mlm <- lm(time ~ diam + type, data = polishing)
summary(mlm)
#slope interpretation
#it takes B more time than reference to (polish) holding diam constant
#p-value of each beta is the chances of finding if no relationship with Base
simple <- lm(time ~diam)
summary(simple)

anova_lm <- aov(time~type)
summary(anova_lm)

#2nd order
polishing$type <- factor(polishing$type)
polishing$type <- relevel(polishing$type, ref = 4)
polishing <-  within(polishing, polishing$type)
lm2 <- lm(time ~ diam * type, data = polishing)
summary(lm2)
#For second order, diam-bowl represents change in time for change in diameter of plate
#difference in rate of change between diam-bowl and diam-tray
